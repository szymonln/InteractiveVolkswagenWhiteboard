{% load static %}
{% get_media_prefix as MEDIA_PREFIX%}
<html>
<head>
    <meta charset="UTF-8">
    <title>iVW</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="bg-secondary">

    <nav class="navbar navbar-expand-sm navbar-dark fixed-bottom" style="background-color:#2A5BA7; height:55px;
                                                                        -webkit-box-shadow: -8px 18px 21px 17px rgba(0,0,0,0.75);
                                                                        -moz-box-shadow: -8px 18px 21px 17px rgba(0,0,0,0.75);
                                                                        box-shadow: -8px 18px 21px 17px rgba(0,0,0,0.75);">

        <!-- FILES STEERING -->
            <div class=fixed-bottom" style="position:relative; top:-46px; left:-7px; margin-right:3px">
                <div class="card text-center border-white" style="background-color:#2A5BA7">
                    <div class="row card-header text-white text-center" style="width:260px">
                        <a id="prev-file" onclick="prevFile()" style="position:relative; left:5px">
                            <span class="carousel-control-prev-icon" style="margin-right:10px; position:relative; top:3px" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <div id="file_manager_name">Files</div>
                        <a id="next-file" onclick="nextFile()" style="position:absolute; right:10px">
                                <span class="carousel-control-next-icon" style="margin-left:10px; position:relative; top:3px" aria-hidden="true"></span>
                                <span class="sr-only">Previous</span>
                              </a>
                    </div>
                    <div class="card-body">
                          <a id="minus-size" class="carousel-control" onclick="diminish()">
                              <div class="btn text-secondary border-white bg-white" style="margin-right:15px; position:relative; top:-2px; ">-</div>
                          </a>
                          <a id="plus-size" onclick="enlarge()">
                              <div class="btn text-secondary border-white bg-white" style="margin-right:15px; position:relative; top:-2px; ">+</div>
                          </a>
                          <a id="draw">
                              <div class="btn text-secondary border-white bg-white" style="margin-right:0px; position:relative; top:-2px; ">Draw</div>
                          </a>

                    </div>
                </div>
            </div>



        <!-- CAROUSEL STEERING -->
            <div class=fixed-bottom" style="position:relative; top:-40px; margin-right:5px">
                <div class="card text-center border-white" style="background-color:#2A5BA7">
                    <div class="card-header text-white">Whiteboards</div>
                    <div class="card-body">
                        <a class="" href="#carouselExampleIndicators" role="button" data-slide="prev" onclick="prevWhiteboard()">
                            <span class="carousel-control-prev-icon" style="margin-right:15px" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                          </a>
                          <a class="" href="#carouselExampleIndicators" role="button" data-slide="next" onclick="nextWhiteboard()">
                            <span class="carousel-control-next-icon"  aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                          </a>
                    </div>
                </div>
            </div>

        <div class="collapse navbar-collapse" id="navbar_content">
            <div class="navbar-nav ml-auto" style="margin-right:5px">
              <a class="navbar-brand mr-auto" style="color:white" href="/">
                 Interactive Volkswagen Whiteboard
               </a>
            </div>
        </div>
        <div class="navbar-nav ml-auto">
              <a class="navbar-brand mr-auto" style="color:white" >
                <img src="/static/volkswagen_logo_no_transparency.png" width="30" height="30" class="d-inline-block align-top" alt="">
              </a>
        </div>

    </nav>

    <div style="padding-bottom:60px">
        <!-- <div class="text-center container-fluid" style="height:100vh; margin-top:25px; margin-bottom:30px">
            <h1 class="h1 mb-3 font-weight-normal text-white">{{name}}</h1> -->
        <div class="container " style="max-width:100%; padding-bottom:80px; margin-top:30px">

            <div id="carouselExampleIndicators" class="carousel slide">
              <div class="carousel-inner">
                  <div class="carousel-item active">
                    <h3 class="text-center text-white">{{whiteboard_active.name}}</h3>
                   <div class="row justify-content-center" id="files">
                    {% for file in whiteboard_active.files.all %}
                        <div class="card" style="margin:10px; min-width:25rem; width:30rem; height:45rem">
                            <div class="card-body">
                                <h5 class="card-title">{{file.name}}</h5>
                                <embed src="{{ MEDIA_PREFIX }}{{ file.path }}" type="application/pdf" width="100%" height="90%" />
                            </div>
                        </div>
                    {% endfor %}
                 </div>
                </div>

                 {% for whiteboard in whiteboards %}
                <div class="carousel-item">
                        <h3 class="text-center text-white">{{whiteboard.name}}</h3>
                   <div class="row justify-content-center" id="files_{{whiteboard.id}}">
                    {% for file in whiteboard.files.all %}
                        <div class="card" style="margin:10px; min-width:25rem; width:30rem; height:45rem">
                            <div class="card-body">
                                <h5 class="card-title">{{file.name}}</h5>
                                <embed src="{{ MEDIA_PREFIX }}{{ file.path }}" type="application/pdf" width="100%" height="90%" />
                            </div>
                        </div>
                    {% endfor %}
                 </div>
                </div>
                {% endfor %}
              </div>
            </div>

        </div>
        </div>
    </div>
</body>
<script>
    $('#carouselExampleIndicators').carousel({
    interval: false
    });

    var files = document.getElementById("files")
    //{% for whiteboard in whiteboards %}
    //    files.append(document.getElementById("files_{{whiteboard.id}}"))
    //{% endfor %}    
    console.log(files.getElementsByClassName("card-title")[0].innerHTML)
    var whiteboard
    var filesList = Array.prototype.slice.call(files.getElementsByClassName("card"))
{% for whiteboard in whiteboards %}
    var whiteboard_{{whiteboard.name}}_files = document.getElementById("files_{{whiteboard.id}}").getElementsByClassName("card")
    whiteboard_{{whiteboard.name}}_array = Array.prototype.slice.call(whiteboard_{{whiteboard.name}}_files)
    console.log(whiteboard_{{whiteboard.name}}_array)

    whiteboard_{{whiteboard.name}}_array.forEach(element => {
        filesList.push(element)
    });
{% endfor %}    

    console.log(filesList)
    var currentFileName = filesList[0].getElementsByClassName("card-title")[0].innerHTML
    var currentFileInd = 0
    var filesCount = filesList.length
    var fileIndicator = document.getElementById("file_manager_name")
    console.log(fileIndicator)
    var whiteboard_name = ""
    fileIndicator.innerHTML = currentFileName.substring(0,15)+ " ...";

    function nextFile(){
        currentFileInd = (currentFileInd + 1) % filesCount
        currentFileName = filesList[currentFileInd].getElementsByClassName("card-title")[0].innerHTML
        fileIndicator.innerHTML = currentFileName.substring(0,15) + " ...";
    }

    function prevFile(){
        currentFileInd = (currentFileInd - 1) % filesCount
        currentFileName = filesList[currentFileInd].getElementsByClassName("card-title")[0].innerHTML
        fileIndicator.innerHTML = currentFileName.substring(0,15)+ " ...";
    }

    function enlarge(){
        currentFile = filesList[currentFileInd]
        width = currentFile.style.width 
        height = currentFile.style.height
        width_int = parseInt(width.substring(0,2))
        height_int = parseInt(height.substring(0,2))
        width_int += 2
        height_int += 2
        currentFile.style.width = width_int +"rem"
        currentFile.style.height = height_int +"rem"
        console.log(currentFile.style.width )
    }

    function diminish(){
        currentFile = filesList[currentFileInd]
        width = currentFile.style.width 
        height = currentFile.style.height
        width_int = parseInt(width.substring(0,2))
        height_int = parseInt(height.substring(0,2))
        width_int -= 2
        height_int -= 2
        currentFile.style.width = width_int +"rem"
        currentFile.style.height = height_int +"rem"
        console.log(currentFile.style.width )
    }



</script>